<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/avatar.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/avatar.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    hostname: new URL('http://http://www.laughingtree.cn').hostname,
    root: '/',
    scheme: 'Mist',
    version: '7.7.0',
    exturl: false,
    sidebar: {"position":"right","display":"post","padding":18,"offset":12,"onmobile":false},
    copycode: {"enable":true,"show_result":true,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":true},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    comments: {"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":true},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}
  };
</script>

  <meta property="og:type" content="website">
<meta property="og:title" content="LaughingTree">
<meta property="og:url" content="http://http//www.laughingtree.cn/page/14/index.html">
<meta property="og:site_name" content="LaughingTree">
<meta property="article:author" content="LiyunZhang">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://http//www.laughingtree.cn/page/14/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: true,
    isPost: false
  };
</script>

  <title>LaughingTree</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">LaughingTree</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>Tags<span class="badge">26</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>Categories<span class="badge">31</span></a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="Searching..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://http//www.laughingtree.cn/2019/11/17/day-03/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="LiyunZhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LaughingTree">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/17/day-03/" class="post-title-link" itemprop="url">day 03</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-11-17 11:03:24" itemprop="dateCreated datePublished" datetime="2019-11-17T11:03:24+08:00">2019-11-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-07 17:36:01" itemprop="dateModified" datetime="2020-08-07T17:36:01+08:00">2020-08-07</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%8B%B1%E8%AF%AD/" itemprop="url" rel="index">
                    <span itemprop="name">英语</span>
                  </a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%8B%B1%E8%AF%AD/%E6%9B%B2%E6%A0%B9%E4%B8%87%E8%AF%8D%E7%8F%AD/" itemprop="url" rel="index">
                    <span itemprop="name">曲根万词班</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <style>
table th:first-of-type {
    width: 150px;
}
</style>


<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">单词</th>
<th style="text-align:center">释义</th>
<th style="text-align:center">备注</th>
<th style="text-align:center">分解</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">ransack</td>
<td style="text-align:center">v. 细细搜索；洗劫</td>
<td style="text-align:center">ran + sack<br />装进麻袋就跑</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">plunder</td>
<td style="text-align:center">v. (以暴力)掠夺</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">plummet</td>
<td style="text-align:center">v. 暴跌</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">plunge</td>
<td style="text-align:center">v. 急降；跳入</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">sag</td>
<td style="text-align:center">v./n. 下降</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">vogue</td>
<td style="text-align:center">n. 时尚；流行</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">fad</td>
<td style="text-align:center">n. 时尚</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">vague</td>
<td style="text-align:center">adj. 模糊的</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">ascribe</td>
<td style="text-align:center">v. 归因于</td>
<td style="text-align:center"><code>a - to</code><br /><code>scribe - to write</code></td>
<td style="text-align:center">a·scribe</td>
</tr>
<tr>
<td style="text-align:center">attribute</td>
<td style="text-align:center">v. 归因于</td>
<td style="text-align:center">attribute to</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">credit</td>
<td style="text-align:center">v. 归因于</td>
<td style="text-align:center">credit to</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">owe</td>
<td style="text-align:center">v. 归因于</td>
<td style="text-align:center">owe to</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">impute</td>
<td style="text-align:center">v. 归因于</td>
<td style="text-align:center"><code>im - to</code><br /><code>put - think</code><br />impute to</td>
<td style="text-align:center">im·pute</td>
</tr>
<tr>
<td style="text-align:center">facet</td>
<td style="text-align:center">n. (事情的)一方面；小平面</td>
<td style="text-align:center"><code>face - 脸</code><br /><code>et - 小</code></td>
<td style="text-align:center">face·(e)t</td>
</tr>
<tr>
<td style="text-align:center">facetious</td>
<td style="text-align:center">adj. 诙谐的</td>
<td style="text-align:center">嬉皮笑脸的，不合时宜的诙谐</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">deface</td>
<td style="text-align:center">v. 损坏(表面)</td>
<td style="text-align:center">把脸(表面)向下挖</td>
<td style="text-align:center">de·face</td>
</tr>
<tr>
<td style="text-align:center">efface</td>
<td style="text-align:center">v. 抹去，擦除</td>
<td style="text-align:center"><code>ef - ex - out</code><br />擦除表面</td>
<td style="text-align:center">ef·face</td>
</tr>
<tr>
<td style="text-align:center">facade</td>
<td style="text-align:center">n. (建筑物的)正面；假象</td>
<td style="text-align:center"><code>ade - 名词后缀</code></td>
<td style="text-align:center">fac(e)·ade</td>
</tr>
<tr>
<td style="text-align:center">phase</td>
<td style="text-align:center">n. 方面；阶段</td>
<td style="text-align:center">ph - f</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">aspect</td>
<td style="text-align:center">n. 方面</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">dubious</td>
<td style="text-align:center">adj. 怀疑的</td>
<td style="text-align:center">doubt</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">skeptical<br />sceptical</td>
<td style="text-align:center">adj. 怀疑的</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">mumble</td>
<td style="text-align:center">v. 喃喃而语；嘀咕抱怨</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">murmur</td>
<td style="text-align:center">v. 低声抱怨；低声说</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">mutter</td>
<td style="text-align:center">v./n. 咕哝；喃喃自语</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">heed</td>
<td style="text-align:center">n. 注意</td>
<td style="text-align:center">give/pay heed (to sb./sth.)<br />take heed (of sb./sth.)</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">smog</td>
<td style="text-align:center">n. 烟雾</td>
<td style="text-align:center">smoke + fog</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">haze</td>
<td style="text-align:center">n. 雾霾</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">fume</td>
<td style="text-align:center">n. 烟  v. 冒烟</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">bulwark</td>
<td style="text-align:center">n. 堡垒</td>
<td style="text-align:center">bole(树干) + work<br />用树干围成堡垒防御</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">fort</td>
<td style="text-align:center">n. 堡垒</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">rampart</td>
<td style="text-align:center">n. 壁垒；保护物</td>
<td style="text-align:center">rim(i → a) - round + part<br />在一个圆圈里保护起来</td>
<td style="text-align:center">ram·part</td>
</tr>
<tr>
<td style="text-align:center">huddle</td>
<td style="text-align:center">v. 挤成一团；蜷缩</td>
<td style="text-align:center">hide(i → u) d双写<br />蜷缩成一团躲起来</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">relic</td>
<td style="text-align:center">n. 遗迹；遗俗</td>
<td style="text-align:center"><code>re - back</code><br /><code>lic - link</code><br />联系过去的东西</td>
<td style="text-align:center">re·lic</td>
</tr>
<tr>
<td style="text-align:center">relinquish</td>
<td style="text-align:center">v. 放弃</td>
<td style="text-align:center">relic(c - qu)</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">remainder</td>
<td style="text-align:center">n. 遗物；遗迹</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">wayfarer</td>
<td style="text-align:center">n. 徒步旅行者；旅行者</td>
<td style="text-align:center">way + far + er<br />路走得很远的人</td>
<td style="text-align:center">way·far·er</td>
</tr>
<tr>
<td style="text-align:center">hitchhiker</td>
<td style="text-align:center">n. 搭便车旅行的人</td>
<td style="text-align:center">hitch(搭便车)</td>
<td style="text-align:center">hitch·hiker</td>
</tr>
<tr>
<td style="text-align:center">wont</td>
<td style="text-align:center">n. 习惯</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">custom</td>
<td style="text-align:center">n. 习惯</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">habitude</td>
<td style="text-align:center">n. 习惯</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">practice</td>
<td style="text-align:center">n. 习惯</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">absolve</td>
<td style="text-align:center">v. 赦免</td>
<td style="text-align:center"><code>ab - away</code><br /><code>solve - loosen(松开)</code></td>
<td style="text-align:center">ab·solve</td>
</tr>
<tr>
<td style="text-align:center">dissolve</td>
<td style="text-align:center">v. 溶解</td>
<td style="text-align:center"><code>dis - apart</code></td>
<td style="text-align:center">dis·solve</td>
</tr>
<tr>
<td style="text-align:center">insolvent</td>
<td style="text-align:center">adj. 破产的；无力偿还债务的</td>
<td style="text-align:center">无法解开的债务</td>
<td style="text-align:center">in·solve·nt</td>
</tr>
<tr>
<td style="text-align:center">exonerate</td>
<td style="text-align:center">v. 免除(对某人的)指控</td>
<td style="text-align:center"><code>oner - 负担</code><br />把某人从负担中解脱出来</td>
<td style="text-align:center">ex·oner·ate</td>
</tr>
<tr>
<td style="text-align:center">exculpate</td>
<td style="text-align:center">v. 证明某人无罪</td>
<td style="text-align:center"><code>culp - guilt</code><br />把某人从罪名中解脱出来</td>
<td style="text-align:center">ex·culp·ate</td>
</tr>
<tr>
<td style="text-align:center">inculpate</td>
<td style="text-align:center">v. 证明某人有罪</td>
<td style="text-align:center">把某人证明到罪名中</td>
<td style="text-align:center">in·culp·ate</td>
</tr>
<tr>
<td style="text-align:center">spare</td>
<td style="text-align:center">v. 赦免</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">deplore</td>
<td style="text-align:center">v. 悲痛；深悔</td>
<td style="text-align:center"><code>de - to</code><br /><code>plore - to cry; weep</code></td>
<td style="text-align:center">de·plore</td>
</tr>
<tr>
<td style="text-align:center">implore</td>
<td style="text-align:center">v. 恳求；哀求</td>
<td style="text-align:center"><code>im - to</code><br />哭着哀求</td>
<td style="text-align:center">im·plore</td>
</tr>
<tr>
<td style="text-align:center">mourn</td>
<td style="text-align:center">v. 悼念；哀悼</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">lament</td>
<td style="text-align:center">n./v. 悲痛</td>
<td style="text-align:center">mental → ment</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">condolence</td>
<td style="text-align:center">n. 哀悼，吊唁</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">contend</td>
<td style="text-align:center">v. 竞争；争论；主张</td>
<td style="text-align:center"><code>tend/tent/tens - to stretch</code><br />一起向外伸展自己的想法<br />向外伸展会引起竞争</td>
<td style="text-align:center">con·tend</td>
</tr>
<tr>
<td style="text-align:center">distend</td>
<td style="text-align:center">v. 扩张，膨胀</td>
<td style="text-align:center"><code>dis - apart</code><br />分开伸展</td>
<td style="text-align:center">dis·tend</td>
</tr>
<tr>
<td style="text-align:center">portend</td>
<td style="text-align:center">v. 预示</td>
<td style="text-align:center"><code>por = pro - 向前</code><br />向前展望</td>
<td style="text-align:center">por·tend</td>
</tr>
<tr>
<td style="text-align:center">tentative</td>
<td style="text-align:center">adj. 暂时的；实验的</td>
<td style="text-align:center"><code>tent - 帐篷 - 临时的</code></td>
<td style="text-align:center">tent·a·tive</td>
</tr>
<tr>
<td style="text-align:center">vie</td>
<td style="text-align:center">v. 竞争</td>
<td style="text-align:center">way(w → v ay → ie)<br />狭路相逢有竞争</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">via</td>
<td style="text-align:center">v. 通过</td>
<td style="text-align:center">way(w → v ay → ia)<br />通过一条路</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">fracture</td>
<td style="text-align:center">n. 骨折；断裂</td>
<td style="text-align:center"><code>fract/frag - to break(fragment)</code></td>
<td style="text-align:center">fract·ure</td>
</tr>
<tr>
<td style="text-align:center">fraction</td>
<td style="text-align:center">n. 部分</td>
<td style="text-align:center">分开的一部分</td>
<td style="text-align:center">fract·ion</td>
</tr>
<tr>
<td style="text-align:center">fractious</td>
<td style="text-align:center">adj. 易怒的；脾气坏的</td>
<td style="text-align:center">爱打破东西的</td>
<td style="text-align:center">fract·ious</td>
</tr>
<tr>
<td style="text-align:center">infraction</td>
<td style="text-align:center">n. 违法行为；违法</td>
<td style="text-align:center"><code>in - to</code><br />往里打破，打破规则</td>
<td style="text-align:center">in·fract·ion</td>
</tr>
<tr>
<td style="text-align:center">fracas</td>
<td style="text-align:center">n. 喧闹</td>
<td style="text-align:center">as frac(t)<br />和打破一样吵闹</td>
<td style="text-align:center">frac·as</td>
</tr>
<tr>
<td style="text-align:center">fragile</td>
<td style="text-align:center">adj. 易碎的</td>
<td style="text-align:center"><code>ile - 易于… 形容词后缀</code></td>
<td style="text-align:center">frag·ile</td>
</tr>
<tr>
<td style="text-align:center">suffrage</td>
<td style="text-align:center">n. 投票权</td>
<td style="text-align:center"><code>su + 辅音双写 = sub</code><br />把陶片打碎以后投下去(陶片放逐法)</td>
<td style="text-align:center">suf·frage</td>
</tr>
<tr>
<td style="text-align:center">shatter</td>
<td style="text-align:center">v./n. 粉碎</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">split</td>
<td style="text-align:center">v. 分裂</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">splinter</td>
<td style="text-align:center">n./v. 碎片；分裂</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">magnitude</td>
<td style="text-align:center">n. 大小；量级；重要性</td>
<td style="text-align:center"><code>magnit - 大max</code></td>
<td style="text-align:center">magnit·ude</td>
</tr>
<tr>
<td style="text-align:center">magnify</td>
<td style="text-align:center">v. 放大；夸大</td>
<td style="text-align:center"><code>fy - 动词后缀</code></td>
<td style="text-align:center">magni·fy</td>
</tr>
<tr>
<td style="text-align:center">magnate</td>
<td style="text-align:center">n. 大人物</td>
<td style="text-align:center"><code>ate - 表示人的后缀</code></td>
<td style="text-align:center">magn·ate</td>
</tr>
<tr>
<td style="text-align:center">magnificent</td>
<td style="text-align:center">adj. 宏伟的，壮丽的</td>
<td style="text-align:center"></td>
<td style="text-align:center">magni·ficent</td>
</tr>
<tr>
<td style="text-align:center">bulk</td>
<td style="text-align:center">n. 大量；大小</td>
<td style="text-align:center">in bulk 大量</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">bias</td>
<td style="text-align:center">n./v. 偏见</td>
<td style="text-align:center">be biased against …</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">unbiased</td>
<td style="text-align:center">adj. 公平的</td>
<td style="text-align:center"></td>
<td style="text-align:center">un·bias·ed</td>
</tr>
<tr>
<td style="text-align:center">prejudice</td>
<td style="text-align:center">n./v. 偏见</td>
<td style="text-align:center"><code>pre - 提前</code><br />提前判断，偏见</td>
<td style="text-align:center">pre·judice</td>
</tr>
<tr>
<td style="text-align:center">discrimination</td>
<td style="text-align:center">n. 偏见</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">nepotism</td>
<td style="text-align:center">n. 裙带关系</td>
<td style="text-align:center">来自nephew</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">pith</td>
<td style="text-align:center">n. 精华部分</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">marrow</td>
<td style="text-align:center">n. 骨髓；精髓</td>
<td style="text-align:center">narrow path<br />marrow pith</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">essence</td>
<td style="text-align:center">n. 精髓；本质</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">core</td>
<td style="text-align:center">n. 核心</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">relish</td>
<td style="text-align:center">v./n. 胃口；喜好</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">zest</td>
<td style="text-align:center">n. 风味</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">savor</td>
<td style="text-align:center">n. 滋味；食欲</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">sneak</td>
<td style="text-align:center">v. 潜行</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">sneaky</td>
<td style="text-align:center">adj. 偷偷摸摸的</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">stealthy</td>
<td style="text-align:center">adj. 鬼鬼祟祟的</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">tide</td>
<td style="text-align:center">n. 潮汐 v. 发生</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">tidings</td>
<td style="text-align:center">n. 消息</td>
<td style="text-align:center">tide - ing<br />正在发生的事</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">intelligence</td>
<td style="text-align:center">n. 情报</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">gossip</td>
<td style="text-align:center">n. 流言蜚语；闲话</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">rumor</td>
<td style="text-align:center">n. 谣言</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">scandal</td>
<td style="text-align:center">n. 丑闻</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">sanctuary</td>
<td style="text-align:center">n. 神殿；圣所</td>
<td style="text-align:center"><code>sanct = sacr(saint)</code><br /><code>ary - 表示人或地点</code></td>
<td style="text-align:center">sanct·u·ary</td>
</tr>
<tr>
<td style="text-align:center">sacrosanct</td>
<td style="text-align:center">adj. 神圣不可侵犯的</td>
<td style="text-align:center"></td>
<td style="text-align:center">sacro·sanct</td>
</tr>
<tr>
<td style="text-align:center">sanction</td>
<td style="text-align:center">n. 授权；制裁</td>
<td style="text-align:center">sanct + action</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">sanctimonious</td>
<td style="text-align:center">adj. 假装虔诚的</td>
<td style="text-align:center">sanct + money<br />为了钱才神圣</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">sanctimony</td>
<td style="text-align:center">n. 假装虔诚</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">sanctify</td>
<td style="text-align:center">v. 使神圣</td>
<td style="text-align:center"></td>
<td style="text-align:center">sanct·ify</td>
</tr>
<tr>
<td style="text-align:center">shrine</td>
<td style="text-align:center">n. 圣殿；圣所</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">precipice</td>
<td style="text-align:center">n. 悬崖</td>
<td style="text-align:center"><code>cip/cap - head</code><br />道路的尽头</td>
<td style="text-align:center">pre·cip·ice</td>
</tr>
<tr>
<td style="text-align:center">precipitous</td>
<td style="text-align:center">adj. 陡峭的</td>
<td style="text-align:center"></td>
<td style="text-align:center">precipi·tous</td>
</tr>
<tr>
<td style="text-align:center">recapitulate</td>
<td style="text-align:center">v. 重述要点</td>
<td style="text-align:center"><code>re - back</code><br />重新把head(重要的)说一遍</td>
<td style="text-align:center">re·cap·itulate</td>
</tr>
<tr>
<td style="text-align:center">capitulate</td>
<td style="text-align:center">v. 投降</td>
<td style="text-align:center">头低下认输</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">cliff</td>
<td style="text-align:center">n. 悬崖</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">cumber</td>
<td style="text-align:center">v. 阻碍</td>
<td style="text-align:center"><code>cumb/cub - lie down</code><br />cucumber 黄瓜立不起来只能躺着<br />横在前方阻碍行动</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">encumber</td>
<td style="text-align:center">v. 阻碍</td>
<td style="text-align:center"></td>
<td style="text-align:center">en·cumber</td>
</tr>
<tr>
<td style="text-align:center">recumbent</td>
<td style="text-align:center">adj. 侧卧的，倚靠的</td>
<td style="text-align:center"><code>re - back</code><br />向后躺，侧卧</td>
<td style="text-align:center">re·cumb·ent</td>
</tr>
<tr>
<td style="text-align:center">incumbent</td>
<td style="text-align:center">adj./n. 在职者(的)；有责任(的)</td>
<td style="text-align:center">it’s incumbent on sb. to do<br />躺在某人怀里，某人有责任<br />躺在职位上，在职</td>
<td style="text-align:center">in·cumbent</td>
</tr>
<tr>
<td style="text-align:center">succumb</td>
<td style="text-align:center">v. 屈服</td>
<td style="text-align:center">躺在地上</td>
<td style="text-align:center">suc·cumb</td>
</tr>
<tr>
<td style="text-align:center">incubate</td>
<td style="text-align:center">v. 孵化</td>
<td style="text-align:center"><code>cub - 幼崽</code><br /><code>in + 名词 + ate 动词</code></td>
<td style="text-align:center">in·cub·ate</td>
</tr>
<tr>
<td style="text-align:center">incubus</td>
<td style="text-align:center">n. 噩梦</td>
<td style="text-align:center">无法躺下睡觉</td>
<td style="text-align:center">in·cub·us</td>
</tr>
<tr>
<td style="text-align:center">hinder</td>
<td style="text-align:center">v. 阻碍</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">hamper</td>
<td style="text-align:center">v. 阻碍</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">impede</td>
<td style="text-align:center">v. 阻碍</td>
<td style="text-align:center"><code>ped - foot</code><br />向里伸脚，阻碍</td>
<td style="text-align:center">im·pede</td>
</tr>
<tr>
<td style="text-align:center">decree</td>
<td style="text-align:center">n./v. 命令；决定</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">aghast</td>
<td style="text-align:center">adj. 惊骇的，恐怖的</td>
<td style="text-align:center">ghost (o → a)<br /><code>a - 表状态的形容词前缀</code></td>
<td style="text-align:center">a·ghast</td>
</tr>
<tr>
<td style="text-align:center">ghastly</td>
<td style="text-align:center">adj. 可怕的，吓人的</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">afoot</td>
<td style="text-align:center">adj./adv. 徒步的；进行中的</td>
<td style="text-align:center">在用脚的状态，徒步的</td>
<td style="text-align:center">a·foot</td>
</tr>
<tr>
<td style="text-align:center">aground</td>
<td style="text-align:center">adj./adv. 搁浅的</td>
<td style="text-align:center">在地上的状态</td>
<td style="text-align:center">a·ground</td>
</tr>
<tr>
<td style="text-align:center">alight</td>
<td style="text-align:center">adj. 燃烧着的，点亮着的</td>
<td style="text-align:center">亮的状态</td>
<td style="text-align:center">a·light</td>
</tr>
<tr>
<td style="text-align:center">akin</td>
<td style="text-align:center">adj. 同族的；类似的</td>
<td style="text-align:center">是亲属的状态</td>
<td style="text-align:center">a·kin</td>
</tr>
<tr>
<td style="text-align:center">frolic</td>
<td style="text-align:center">v. 嬉戏；作乐</td>
<td style="text-align:center"><code>lic - lure(delicious)</code><br /><code>fro - 相互</code><br />动名词：frolicking<br />过去分词：frolicked</td>
<td style="text-align:center">fro·lic</td>
</tr>
<tr>
<td style="text-align:center">elicit</td>
<td style="text-align:center">v. 引出</td>
<td style="text-align:center"><code>e - ex - out</code><br />诱惑出来</td>
<td style="text-align:center">e·lic·it</td>
</tr>
<tr>
<td style="text-align:center">frisk</td>
<td style="text-align:center">v. 雀跃</td>
<td style="text-align:center">free + sky<br />frisk around</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">lark</td>
<td style="text-align:center">v. 嬉戏</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">cavort</td>
<td style="text-align:center">v. 欢跃，嬉戏</td>
<td style="text-align:center"><code>ca - co - 一起</code><br /><code>vort - vert - ture</code></td>
<td style="text-align:center">ca·vort</td>
</tr>
<tr>
<td style="text-align:center">intercourse</td>
<td style="text-align:center">n. 交流；性交</td>
<td style="text-align:center"><code>inter - 互相</code><br /><code>cour/cur - to run</code><br />相互走动交流</td>
<td style="text-align:center">inter·cour·se</td>
</tr>
<tr>
<td style="text-align:center">discourse</td>
<td style="text-align:center">n. 谈论；演讲</td>
<td style="text-align:center"><code>dis - apart</code><br />四处走动讲课</td>
<td style="text-align:center">dis·cour·se</td>
</tr>
<tr>
<td style="text-align:center">recourse</td>
<td style="text-align:center">n. 求助</td>
<td style="text-align:center"><code>re - back</code><br />向后跑，向后方求助</td>
<td style="text-align:center">re·cour·se</td>
</tr>
<tr>
<td style="text-align:center">succor</td>
<td style="text-align:center">v. 援救</td>
<td style="text-align:center"><code>su + 辅音双写 - down</code><br />向下走动，救援底下的人</td>
<td style="text-align:center">suc·cor</td>
</tr>
<tr>
<td style="text-align:center">incursion</td>
<td style="text-align:center">n. 入侵</td>
<td style="text-align:center">cour把o脱掉<br />走到别的国家里面</td>
<td style="text-align:center">in·cur·sion</td>
</tr>
<tr>
<td style="text-align:center">excursion</td>
<td style="text-align:center">n. 远足</td>
<td style="text-align:center">同上<br />走到外面去</td>
<td style="text-align:center">ex·cur·sion</td>
</tr>
<tr>
<td style="text-align:center">cursive</td>
<td style="text-align:center">adj. 潦草的</td>
<td style="text-align:center">cursive writing<br />边跑边写字，字迹潦草</td>
<td style="text-align:center">cur·sive</td>
</tr>
<tr>
<td style="text-align:center">cursory</td>
<td style="text-align:center">adj. 鲁莽的；匆忙的</td>
<td style="text-align:center">跑来跑去</td>
<td style="text-align:center">cur·sory</td>
</tr>
<tr>
<td style="text-align:center">menace</td>
<td style="text-align:center">n. 威胁</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">intimidation</td>
<td style="text-align:center">n. 威胁</td>
<td style="text-align:center"><code>in - to</code><br />威胁让一个人害怕(timid)</td>
<td style="text-align:center">in·timid·ation</td>
</tr>
<tr>
<td style="text-align:center">cow</td>
<td style="text-align:center">v. 恐吓</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">coerce</td>
<td style="text-align:center">v. 恐吓</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">browbeat</td>
<td style="text-align:center">v. 恐吓</td>
<td style="text-align:center">eyebrow吹胡子瞪眼</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">germinate</td>
<td style="text-align:center">v. 发芽，生长</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">shoot</td>
<td style="text-align:center">v. 发芽</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">tread</td>
<td style="text-align:center">v. 行走；踩</td>
<td style="text-align:center">过去式：trod<br />过去分词：trodden</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">trample</td>
<td style="text-align:center">v. 踩；踩踏</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">step on<br />stamp</td>
<td style="text-align:center">v. 踏，用力踩</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
</div>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://http//www.laughingtree.cn/2019/11/09/%E6%9C%80%E5%B0%8F%E6%94%AF%E6%92%91%E6%A0%91-Kruskal%E7%AE%97%E6%B3%95%E3%80%81Prim%E7%AE%97%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="LiyunZhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LaughingTree">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/09/%E6%9C%80%E5%B0%8F%E6%94%AF%E6%92%91%E6%A0%91-Kruskal%E7%AE%97%E6%B3%95%E3%80%81Prim%E7%AE%97%E6%B3%95/" class="post-title-link" itemprop="url">最小支撑树(Kruskal算法、Prim算法)</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-11-09 00:49:39" itemprop="dateCreated datePublished" datetime="2019-11-09T00:49:39+08:00">2019-11-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-07 22:30:59" itemprop="dateModified" datetime="2020-08-07T22:30:59+08:00">2020-08-07</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95/" itemprop="url" rel="index">
                    <span itemprop="name">算法</span>
                  </a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95/%E5%9B%BE%E8%AE%BA/" itemprop="url" rel="index">
                    <span itemprop="name">图论</span>
                  </a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95/%E5%9B%BE%E8%AE%BA/%E5%85%B6%E4%BB%96/" itemprop="url" rel="index">
                    <span itemprop="name">其他</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h1><p>一个无向带权图有n个节点，选择其中的若干条边，使得所有的点都连通，且使得所选择的边的权值和最小。<br>易知已经连起来的点和把他们连起来的边必然是一棵树(无环)</p>
<h1 id="Kruskal算法"><a href="#Kruskal算法" class="headerlink" title="Kruskal算法"></a>Kruskal算法</h1><p>基础：<a href="https://blog.csdn.net/ValarMorg/article/details/88857396" target="_blank" rel="noopener">并查集</a><br>基本思想：贪心<br>每次都选择不在已经选择的树内的最短边，一共要选n - 1条边<br><strong>数据存储</strong>：一个结构体数组存储边的信息——起点、终点、长度</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	<span class="keyword">int</span> start, <span class="built_in">end</span>, length;</span><br><span class="line">&#125; e[maxn];</span><br><span class="line"></span><br><span class="line"><span class="comment">//按长度排序</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(edge a, edge b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> a.length &lt; b.length;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> unioinFind[maxn];</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">...此处省略并查集实现</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Kruskal</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">kruskal</span><span class="params">(<span class="keyword">int</span> num, <span class="keyword">int</span> n)</span>   <span class="comment">//num为边的个数，n为点数</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	sort(e, e + n, cmp);    <span class="comment">//把边的大小从小排到大</span></span><br><span class="line">	<span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> edgeNum = <span class="number">0</span>;    <span class="comment">//标记找到了几条边</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; num &amp;&amp; edgeNum &lt; n - <span class="number">1</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">//每次都找最短的</span></span><br><span class="line">		<span class="keyword">int</span> one = <span class="built_in">find</span>(e[i].start);</span><br><span class="line">		<span class="keyword">int</span> two = <span class="built_in">find</span>(e[i].<span class="built_in">end</span>);</span><br><span class="line">		<span class="keyword">if</span>(one != two)</span><br><span class="line">		&#123;</span><br><span class="line">			merge(one, two);</span><br><span class="line">			edgeNum++;</span><br><span class="line">			ans += e[i].length;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="Prim算法"><a href="#Prim算法" class="headerlink" title="Prim算法"></a>Prim算法</h1><p>割：图中两个无交集的点集<br>基本思想还是贪心，每次选择两个割的最小跨边<br><strong>数据存储</strong>：一个邻接表存储点之间的连接情况，一个一维数组vis表示是否在树中，一个向量存储在树中的点<br>为了方便，每次都选择最小编号(假设为1)的点开始</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	<span class="keyword">int</span> to, length;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">vector</span>&lt;edge&gt; graph[maxn];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; tree;</span><br><span class="line"><span class="keyword">int</span> vis[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">prim</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">	tree.push_back(<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++) <span class="comment">//要找n - 1条边</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span> <span class="built_in">min</span> = INF, indexTree, indexGraph;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; tree.<span class="built_in">size</span>(); j++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; graph[tree[j]].<span class="built_in">size</span>(); k++)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">if</span>(<span class="built_in">min</span> &gt; graph[tree[j]][k].length &amp;&amp; !vis[graph[tree[j]][k].to])<span class="comment">//小且在树外</span></span><br><span class="line">				&#123;</span><br><span class="line">					<span class="built_in">min</span> = graph[tree[j]][k].length;</span><br><span class="line">					indexTree = j;</span><br><span class="line">					indexGraph = k;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		ans += <span class="built_in">min</span>;</span><br><span class="line">		vis[graph[tree[indexTree]][indexGraph].to] = <span class="number">1</span>;   <span class="comment">//标记新加入的点</span></span><br><span class="line">		tree.push_back(graph[tree[indexTree]][indexGraph].to);   <span class="comment">//把点加入树</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="最大生成树"><a href="#最大生成树" class="headerlink" title="最大生成树"></a>最大生成树</h1><p>最大生成树只是最小生成树的反式写法，最小生成树都取最小，最大生成树都取最大<br>例如：<a href="https://www.luogu.org/problemnew/show/P4826" target="_blank" rel="noopener">洛谷 P4826</a><br>每只牛之间的比赛连一条边，边的权值就是两只牛的异或，建立一张图，因为每只牛都要参加比赛，除了最后那一只牛，每只牛都会且只会输一场，又不会出现环，就可以构建出一棵树，求最大生成树</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> repLess(ele, init, lim) for(int ele = init; ele &lt; lim; ele++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> repLE(ele, init, lim) for(int ele = init; ele &lt;= lim; ele++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> repMore(ele, init, lim) for(int ele = init; ele &gt; lim; ele--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> repME(ele, init, lim) for(int ele = init; ele &gt;= lim; ele--)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> scInt(to) scanf(<span class="meta-string">"%d"</span>, &amp;to)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> scTwoInt(one, two) scanf(<span class="meta-string">"%d%d"</span>, &amp;one, &amp;two)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> scThreeInt(one, two, three) scanf(<span class="meta-string">"%d%d%d"</span>, &amp;one, &amp;two, &amp;three)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> clr(arr, init) memset(arr, init, sizeof(arr))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rc ((o &lt;&lt; 1) + 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lc (o &lt;&lt; 1)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> EPS = <span class="number">1e-8</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">2e5</span> + <span class="number">50</span>;</span><br><span class="line"></span><br><span class="line">ll cow[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> a, b;</span><br><span class="line">    ll weight;</span><br><span class="line">&#125; e[MAXN &lt;&lt; <span class="number">4</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(edge a, edge b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a.weight &gt; b.weight;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> disjoint[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (disjoint[x] == x)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> disjoint[x];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> disjoint[x] = find(disjoint[x]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    repLE(i, <span class="number">1</span>, n)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;cow[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> len = <span class="number">0</span>;</span><br><span class="line">    repLE(i, <span class="number">1</span>, n)</span><br><span class="line">    &#123;</span><br><span class="line">        repLess(j, <span class="number">1</span>, i)</span><br><span class="line">        &#123;</span><br><span class="line">            e[len].weight = (<span class="number">1L</span>L * cow[i]) ^ cow[j];</span><br><span class="line">            e[len].a = i;</span><br><span class="line">            e[len].b = j;</span><br><span class="line">            len++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    sort(e, e + len, cmp);</span><br><span class="line">    repLE(i, <span class="number">0</span>, n)</span><br><span class="line">    &#123;</span><br><span class="line">        disjoint[i] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> getEdge = <span class="number">0</span>;</span><br><span class="line">    repLess(pos, <span class="number">0</span>, len)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> x = find(e[pos].a), y = find(e[pos].b);</span><br><span class="line">        <span class="keyword">if</span> (x == y)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        disjoint[x] = y;</span><br><span class="line">        ans += e[pos].weight;</span><br><span class="line">        getEdge++;</span><br><span class="line">        <span class="keyword">if</span> (getEdge == n - <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://http//www.laughingtree.cn/2019/11/09/%E5%BC%BA%E8%BF%9E%E9%80%9A%E5%9B%BE-Tarjan%E7%AE%97%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="LiyunZhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LaughingTree">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/09/%E5%BC%BA%E8%BF%9E%E9%80%9A%E5%9B%BE-Tarjan%E7%AE%97%E6%B3%95/" class="post-title-link" itemprop="url">强连通图(Tarjan算法)</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-11-09 00:46:44" itemprop="dateCreated datePublished" datetime="2019-11-09T00:46:44+08:00">2019-11-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-07 17:43:42" itemprop="dateModified" datetime="2020-08-07T17:43:42+08:00">2020-08-07</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95/" itemprop="url" rel="index">
                    <span itemprop="name">算法</span>
                  </a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95/%E5%9B%BE%E8%AE%BA/" itemprop="url" rel="index">
                    <span itemprop="name">图论</span>
                  </a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95/%E5%9B%BE%E8%AE%BA/%E5%85%B6%E4%BB%96/" itemprop="url" rel="index">
                    <span itemprop="name">其他</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h1><p>强连通：如果a点和b点可互达，则称a和b强连通<br>强连通图：如果一个图中的任意两个点之间都是强连通，则称该图为强连通图<br>强连通分量：一个图的子图是一个强连通图，则称该子图就是原图的一个强连通分量</p>
<h1 id="Tarjan算法"><a href="#Tarjan算法" class="headerlink" title="Tarjan算法"></a>Tarjan算法</h1><p><strong>需要存储的信息</strong>：首先肯定要有一个邻接表/邻接矩阵来存储边的信息，一个DFN数组存储该点的访问时间戳(即第几个被访问)，还要有一个low数组储存在一个强连通分量中根节点的的时间戳，还要有一个栈存储当前可访问到的点，以及一个vis数组存储一个元素是否在栈中<br><strong>思路</strong>：利用DFS，从一个点出发，延着有向边不断遍历，如果一个点已经在栈中，则说明这两个点强连通，就把这个强连通图的根结点设为时间戳小的那个<br>代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; mp[MAXN];</span><br><span class="line"><span class="built_in">stack</span>&lt;<span class="keyword">int</span>&gt; sta;</span><br><span class="line"><span class="keyword">int</span> low[MAXN], DFN[MAXN], vis[MAXN], </span><br><span class="line"><span class="keyword">int</span> index = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tarjan</span><span class="params">(<span class="keyword">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	low[v] = DFN[v] = ++index;</span><br><span class="line">	sta.push(v);</span><br><span class="line">	vis[v] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; mp[v].<span class="built_in">size</span>(); i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(!DFN[mp[v][i]])</span><br><span class="line">		&#123;</span><br><span class="line">			tarjan(mp[v][i]);</span><br><span class="line">			low[v] = <span class="built_in">min</span>(low[v], low[mp[v][i]]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(vis[mp[v][i]])</span><br><span class="line">		&#123;</span><br><span class="line">			low[v] = <span class="built_in">min</span>(low[v], low[mp[v][i]]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (low[v] == DFN[v])</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">int</span> x = sta.top();</span><br><span class="line">			sta.pop();</span><br><span class="line">			vis[x] = <span class="number">0</span>;</span><br><span class="line">			index--;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%d\n"</span>, x);</span><br><span class="line">			<span class="keyword">if</span>(x == v)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>调用：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(DFN, <span class="number">0</span>, <span class="keyword">sizeof</span>(DFN));</span><br><span class="line">	<span class="built_in">memset</span>(low, <span class="number">0</span>, <span class="keyword">sizeof</span>(low));</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(!DFN[i])</span><br><span class="line">		&#123;</span><br><span class="line">			tarjan(i);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://http//www.laughingtree.cn/2019/11/09/2-sat%E7%AE%97%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="LiyunZhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LaughingTree">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/09/2-sat%E7%AE%97%E6%B3%95/" class="post-title-link" itemprop="url">2-sat算法</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-11-09 00:45:46" itemprop="dateCreated datePublished" datetime="2019-11-09T00:45:46+08:00">2019-11-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-07 17:43:29" itemprop="dateModified" datetime="2020-08-07T17:43:29+08:00">2020-08-07</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95/" itemprop="url" rel="index">
                    <span itemprop="name">算法</span>
                  </a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95/%E5%9B%BE%E8%AE%BA/" itemprop="url" rel="index">
                    <span itemprop="name">图论</span>
                  </a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95/%E5%9B%BE%E8%AE%BA/%E5%85%B6%E4%BB%96/" itemprop="url" rel="index">
                    <span itemprop="name">其他</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h1><p>2-sat算法为可满足算法中的特例，对于k-sat算法，若k &gt; 2，则问题是一个NP完全问题，但2-sat不是。2-sat问题一般是：每一个集合里都有两个元素，不同集合里的元素之间可能有矛盾，现在要从每一个集合里都取出一个元素作为代表，且取出的元素两两之间没有矛盾</p>
<h1 id="解法"><a href="#解法" class="headerlink" title="解法"></a>解法</h1><p><strong>构图</strong>：记i和i’是同一个集合里的两个元素，则易得如果i和j有矛盾，则选了i就必选j’，选了j就必选i’。如果选了i就必选j’我们就连一条从i到j’的有向边<br><strong>主体思想</strong>：从一个点出发沿着有向边一直走，选择路过的每一个点<br><strong>失败判断</strong>：走到一个点，那个点所在的集合内的两个点都被标记了<br><strong>失败后的处理</strong>：先清空标记，把失败这次的开始节点换成该集合内的另一个节点，如果还失败就说明无解<br><strong>代码</strong>(假设2i - 1和2i是在同一个集合里)</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; mp[MAXN];</span><br><span class="line"><span class="keyword">int</span> mark[MAXN], ans[MAXN];</span><br><span class="line"><span class="comment">//mark记录在该次遍历中经过的点，用于清除记录(如果失败)，ans就标记的是选中的点</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getAnother</span><span class="params">(<span class="keyword">int</span> x)</span> <span class="comment">//获得该集合内另一点的标号</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x % <span class="number">2</span> ? x + <span class="number">1</span> : x - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//建图</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> m)</span>   <span class="comment">//m：矛盾对的个数</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        mp[arr[i].x].push_back(getAnother(arr[i].y));</span><br><span class="line">        mp[arr[i].y].push_back(getAnother(arr[i].x));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> n, <span class="keyword">int</span> &amp; len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(ans[getAnother(x)]) <span class="comment">//一个集合内有两个点被标记</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(ans[x])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ans[x] = <span class="number">1</span>;</span><br><span class="line">    mark[len++] = x;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; mp[x].<span class="built_in">size</span>(); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!dfs(mp[x][i], n, len))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">two_sat</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(ans, <span class="number">0</span>, <span class="keyword">sizeof</span>(ans));</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="comment">//遍历所有的集合</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!ans[i &lt;&lt; <span class="number">1</span>] &amp;&amp; !ans[(i &lt;&lt; <span class="number">1</span>) - <span class="number">1</span>])</span><br><span class="line">        &#123;</span><br><span class="line">            len = <span class="number">0</span>; <span class="comment">//在这次遍历中直到失败/结束访问的节点的个数</span></span><br><span class="line">            <span class="keyword">if</span>(!dfs((i &lt;&lt; <span class="number">1</span>) - <span class="number">1</span>, n, len)) <span class="comment">//失败</span></span><br><span class="line">            &#123;</span><br><span class="line">            	<span class="comment">//先清除记录</span></span><br><span class="line">                <span class="keyword">while</span>(len)</span><br><span class="line">                &#123;</span><br><span class="line">                    ans[mark[--len]] = <span class="number">0</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">//再从集合内另一个点开始遍历</span></span><br><span class="line">                <span class="keyword">if</span>(!dfs((i &lt;&lt; <span class="number">1</span>), n, len))</span><br><span class="line">                &#123;</span><br><span class="line">                	<span class="comment">//再失败就说明无解</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="优化"><a href="#优化" class="headerlink" title="优化"></a>优化</h1><p>有向图中经常会有环，根据上面对边的定义，可以发现环中的每一个元素要么都选要么都不选，而且这个问题中的环都是对称的，我们就可以利用强连通分量把多个形成环的点缩成一个点，减少点数</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://http//www.laughingtree.cn/2019/11/09/%E6%90%9C%E7%B4%A2%E4%B9%8B%E6%9E%9A%E4%B8%BE-%E7%86%84%E7%81%AF%E9%97%AE%E9%A2%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="LiyunZhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LaughingTree">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/09/%E6%90%9C%E7%B4%A2%E4%B9%8B%E6%9E%9A%E4%B8%BE-%E7%86%84%E7%81%AF%E9%97%AE%E9%A2%98/" class="post-title-link" itemprop="url">搜索之枚举(熄灯问题)</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-11-09 00:44:50" itemprop="dateCreated datePublished" datetime="2019-11-09T00:44:50+08:00">2019-11-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-07 17:43:17" itemprop="dateModified" datetime="2020-08-07T17:43:17+08:00">2020-08-07</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95/" itemprop="url" rel="index">
                    <span itemprop="name">算法</span>
                  </a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95/%E6%90%9C%E7%B4%A2/" itemprop="url" rel="index">
                    <span itemprop="name">搜索</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h1><p>一个矩阵排列的灯阵，有的是亮的，有的是灭的。每一个灯都有一个按钮，每个按钮都控制五个灯，分别是按钮直接连的灯和这个灯的上下左右各一个灯，例如位于(2, 3)的按钮可以用控制(2, 3)、(1, 3)、(2, 2)、(2, 4)、(3, 3)。按下按钮后其控制的每一盏灯如果是亮的就灭掉，如果是暗的就亮起来。现在给定一个n×m灯阵，求可以把他们都灭掉的方法</p>
<h1 id="状态压缩"><a href="#状态压缩" class="headerlink" title="状态压缩"></a>状态压缩</h1><p>一直以为状压是高深莫测的东西，原来这就是最经典的01状压。状压就是把物体的状态压缩成一个个整型，存储操作起来方便。状压常和其他算法结合，常见的有动态规划、线段树和搜索。这题就是状压加搜索，把亮灯状态压缩成1，暗灯状态压缩成0。</p>
<h1 id="直观思路"><a href="#直观思路" class="headerlink" title="直观思路"></a>直观思路</h1><p>遍历所有的开关操作，验证是否可以关掉所有的灯。但复杂度是O(mn2^mn^)，高得不可接受。虽然这是一个NP完全问题，但我们还是可以尝试降低一点复杂度，使算法更优</p>
<h1 id="优化"><a href="#优化" class="headerlink" title="优化"></a>优化</h1><p>易知有以下事实：<br>&emsp;1) 一个灯的状态变化偶数次，那个灯的最终状态就和初状态一样；<br>&emsp;2) 第i行中每盏点亮的灯都可以在第i+1行中按对应的按钮来熄灭它<br>由事实1我们可以以知道每个按钮最多按一次<br>由事实1和2我们可以推理如下：<br>&emsp;1) 如果一盏灯是亮的我们就要按奇数次控制它的开关来熄灭它，如果是暗的我们就要按偶数次来维持它暗的性质，所以如果一个点初始时是1，那其四周的点的和要为奇数；否则为偶数，即奇偶性一致<br>&emsp;2) 设记录灯原始状态的数组为lamp，按钮按的次数的数组为push，则有<code>(push[i][j] + push[i][j - 1] + push[i][j + 1] + push[i + 1][j] + push[i - 1][j]) % 2 == lamp[i][j]</code><br>&emsp;3) 由推论2)得<code>push[i][j] + push[i][j - 1] + push[i][j + 1] + push[i + 1][j] + push[i - 1][j] == (2k - 1)lamp[i][j]</code>，可以推出<code>push[i][j] + push[i][j - 1] + push[i][j + 1] + lamp[i][j] + push[i - 1][j] == 2k * lamp[i][j] - push[i + 1][j]</code>由于<code>2k * lamp[i][j]</code>为偶数，所以<code>2k * lamp[i][j] - push[i + 1][j]</code>的奇偶性与 <code>push[i + 1][j]</code>一致，所以有<code>(lamp[i][j] + push[i][j] + push[i][j - 1] + push[i][j + 1] + push[i - 1][j]) % 2 == push[i + 1][j]</code><br>&emsp;4) 我们可以通过第一行的按钮使用状态推出第二行要使第一行全熄灭的状态，直到最后一行<br>由推论4，我们想到了可以推出当运行到最后一行时，以上的所以灯都是熄灭的，因为我们每一行的目标都是使上一行的灯全部熄灭，当又不会影响到再上一行。而推论2又给了我们一个判断最后一行是否熄灭的办法<br><code>注：为什么要用推论2和3：可以在不改变原始数组的情况下得到所要的结果</code><br>由此，我们就想到了优化的办法：枚举第一行的所有操作，推出以下操作，判断是否可行。复杂度就降到了O(mn2^m^)</p>
<h1 id="推理第二行及以下操作并判断是否可行"><a href="#推理第二行及以下操作并判断是否可行" class="headerlink" title="推理第二行及以下操作并判断是否可行"></a>推理第二行及以下操作并判断是否可行</h1><p>有一个优化代码的细节：如果我们从0开始存储，就会遇到要判断是否越界的情况，但如果我们从1开始存储并在末尾留充足的空间，并全部初始化为0就可以都用同一种操作<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> lamp[maxn][maxm], push[maxn][maxm];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">guess</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//推理第二行及以下操作</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; j++)</span><br><span class="line">		&#123;</span><br><span class="line">			push[i + <span class="number">1</span>][j] = (push[i][j] + push[i][j - <span class="number">1</span>] + push[i][j + <span class="number">1</span>] + push[i - <span class="number">1</span>][j] + lamp[i][j]) % <span class="number">2</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//判断是否可行</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">//最后一行，不必加上下一行的操作</span></span><br><span class="line">		<span class="keyword">if</span>((push[n][i] + push[n][i - <span class="number">1</span>] + push[n][i] + push[n - <span class="number">1</span>][i]) % <span class="number">2</span> != lamp[n][i])</span><br><span class="line">			<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> cnt = <span class="number">0</span>;   <span class="comment">//返回操作次数</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; j++)</span><br><span class="line">			cnt += push[i][j];</span><br><span class="line">	<span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="枚举第一行的所有状态"><a href="#枚举第一行的所有状态" class="headerlink" title="枚举第一行的所有状态"></a>枚举第一行的所有状态</h1><p>枚举利用二进制的位运算，二进制第i位为1就表示按下按钮，0表示不操作</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//利用二进制初始化push数组</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">importPush</span><span class="params">(<span class="keyword">int</span> binary)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = m; i &gt; <span class="number">0</span>; i--)</span><br><span class="line">	&#123;</span><br><span class="line">		push[<span class="number">1</span>][i] = binary &amp; <span class="number">1</span>; <span class="comment">//push[1][i]的值就是当前binary的最低位的值</span></span><br><span class="line">		binary &gt;&gt;= <span class="number">1</span>; <span class="comment">//没导入完一个以后就右移一位，把下一位暴露出来，给下一次导入使用</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>易知，灯的所有状态从全为0开始，到全为1结束</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> <span class="built_in">min</span> = <span class="number">-1</span>, ans = <span class="number">-1</span>; <span class="comment">//返回可行且操作数最小的第一行状态(二进制数)</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">1</span> &lt;&lt; m; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		importPush(i);  <span class="comment">//先导入</span></span><br><span class="line">		<span class="keyword">int</span> temp = guess();</span><br><span class="line">		<span class="keyword">if</span>(temp &gt;= <span class="number">0</span> &amp;&amp; (temp &lt; <span class="built_in">min</span> || <span class="built_in">min</span> &lt; <span class="number">0</span>))</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">min</span> = temp;</span><br><span class="line">			ans = i;</span><br><span class="line">		&#125; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="主函数"><a href="#主函数" class="headerlink" title="主函数"></a>主函数</h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//这里读入数据</span></span><br><span class="line">	<span class="keyword">int</span> ans = solve();</span><br><span class="line">	<span class="keyword">if</span>(ans &lt; <span class="number">0</span>)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"IMPOSSIBLE\n"</span>);</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		guess(ans, n, m);</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%d"</span>, push[i][<span class="number">0</span>]);</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; j++)</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">" %d"</span>, push[i][j]);</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h1 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h1><p><a href="https://vjudge.net/problem/POJ-3279" target="_blank" rel="noopener">POJ 3279(Fliptile)</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://http//www.laughingtree.cn/2019/11/09/%E6%90%9C%E7%B4%A2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="LiyunZhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LaughingTree">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/09/%E6%90%9C%E7%B4%A2/" class="post-title-link" itemprop="url">搜索</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-11-09 00:44:05" itemprop="dateCreated datePublished" datetime="2019-11-09T00:44:05+08:00">2019-11-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-21 11:16:50" itemprop="dateModified" datetime="2020-08-21T11:16:50+08:00">2020-08-21</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95/" itemprop="url" rel="index">
                    <span itemprop="name">算法</span>
                  </a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95/%E6%90%9C%E7%B4%A2/" itemprop="url" rel="index">
                    <span itemprop="name">搜索</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="双源BFS"><a href="#双源BFS" class="headerlink" title="双源BFS"></a>双源BFS</h1><p>有两个起点的BFS，注意，在搜索的时候是搜两颗树(虽然通常两颗数在原图中可能最后会相交)，每次搜索都是一棵树搜一层，另一棵树搜一层。搜索时在开始就把两个起点都加入到同一个队列中，根据BFS是树的层次遍历知——只需要依次取出队列的首元素就可以做到轮流搜一层的效果</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">BFS</span><span class="params">(Node a, Node b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">queue</span>&lt;Node&gt; q;</span><br><span class="line">    </span><br><span class="line">    q.push(a);</span><br><span class="line">    q.push(b); <span class="comment">//加入同一个队列</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span>(!q.empty())</span><br><span class="line">    &#123;</span><br><span class="line">        a = q.front();</span><br><span class="line">        q.pop();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span>(...) <span class="comment">//遍历a的子节点</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">            ...生成一个a的子节点b</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line">            <span class="keyword">if</span>(judge(b)) <span class="comment">//如果b合法</span></span><br><span class="line">            &#123;</span><br><span class="line">                q.push(b);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a href="https://vjudge.net/problem/FZU-2150" target="_blank" rel="noopener">FZU 2150</a></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">15</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> dx[<span class="number">5</span>] = &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">-1</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> dy[<span class="number">5</span>] = &#123;<span class="number">1</span>, <span class="number">-1</span>, <span class="number">0</span>, <span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> x, y, cnt ;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span>&lt;Node&gt; v;</span><br><span class="line"><span class="keyword">char</span> mp[N][N];</span><br><span class="line"><span class="keyword">int</span> vis[N][N];</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">judge</span><span class="params">(Node b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> b.x&gt;<span class="number">0</span> &amp;&amp; b.y&gt;<span class="number">0</span> &amp;&amp; b.x&lt;=n &amp;&amp; b.y&lt;=m &amp;&amp; vis[b.x][b.y]==<span class="number">0</span> &amp;&amp; mp[b.x][b.y]==<span class="string">'#'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">BFS</span><span class="params">(Node a,Node b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="keyword">sizeof</span>(vis));</span><br><span class="line">    <span class="built_in">queue</span>&lt;Node&gt; q;</span><br><span class="line">    vis[a.x][a.y]  = vis[b.x][b.y] = <span class="number">1</span>;</span><br><span class="line">    a.cnt = <span class="number">0</span>,b.cnt = <span class="number">0</span>;</span><br><span class="line">    q.push(a);</span><br><span class="line">    q.push(b);</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line">    <span class="keyword">int</span> cas = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(!q.empty())</span><br><span class="line">    &#123;</span><br><span class="line">        a = q.front();</span><br><span class="line">        q.pop();</span><br><span class="line">        ans = a.cnt;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            b.x = a.x + dx[i];</span><br><span class="line">            b.y = a.y + dy[i];</span><br><span class="line">            b.cnt = a.cnt + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(judge(b))</span><br><span class="line">            &#123;</span><br><span class="line">                vis[b.x][b.y] = <span class="number">1</span>;</span><br><span class="line">                q.push(b);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> kase = <span class="number">1</span>; kase &lt;= T; kase++)</span><br><span class="line">    &#123;</span><br><span class="line">        v.<span class="built_in">clear</span>();</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            getchar();</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; j++)&#123;</span><br><span class="line">                <span class="built_in">scanf</span>(<span class="string">"%c"</span>, &amp;mp[i][j]);</span><br><span class="line">                <span class="keyword">if</span>(mp[i][j] == <span class="string">'#'</span>)</span><br><span class="line">                    v.push_back((Node)&#123;i, j, <span class="number">0</span>&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; v.<span class="built_in">size</span>(); i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = i; j &lt; v.<span class="built_in">size</span>(); j++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">int</span> tmp = BFS(v[i], v[j]);</span><br><span class="line">                <span class="keyword">bool</span> ok = <span class="literal">true</span>;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= n; k++)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">for</span>(<span class="keyword">int</span> f = <span class="number">1</span>; f &lt;= m; f++)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">if</span>(vis[k][f] == <span class="number">0</span> &amp;&amp; mp[k][f] == <span class="string">'#'</span>)</span><br><span class="line">                        &#123;</span><br><span class="line">                            ok = <span class="literal">false</span>;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(ok == <span class="literal">false</span>)</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(ok)</span><br><span class="line">                &#123;</span><br><span class="line">                    ans = <span class="built_in">min</span>(ans, tmp);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Case %d: "</span>, kase);</span><br><span class="line">        <span class="keyword">if</span>(ans == <span class="number">0x3f3f3f3f</span>)</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">"-1"</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="DFS序"><a href="#DFS序" class="headerlink" title="DFS序"></a>DFS序</h1><ol>
<li>DFS序：利用DFS遍历一颗树的时候，各个节点是被遍历的顺序</li>
<li>性质：一个节点以及以这个节点为根节点的子树中的所有节点的DFS序是连续的，可以利用DFS序来标注节点之间的关系</li>
<li>一种方法是记录DFS序并记录子树的规模，则节点$i$的子树DFS序标号为$dfsNum[i]\sim dfsNum[i]+size[i]-1$<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> dfsNum[MAXN], <span class="built_in">size</span>[MAXN]; <span class="comment">// dfsNum记录每个节点的DFS序标号，size记录每个节点子树的规模</span></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; sons[MAXN]; <span class="comment">// 记录每个节点的子节点</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> deep;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> node)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  dfsNum[node] = ++deep;</span><br><span class="line">  <span class="built_in">size</span>[node] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; sons[node].<span class="built_in">size</span>(); i++)</span><br><span class="line">  &#123;</span><br><span class="line">    dfs(sons[node][i]);</span><br><span class="line">    <span class="built_in">size</span>[node] += <span class="built_in">size</span>[sons[node][i]];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>每一个节点实际上会被访问两次，开始遍历子树之前、遍历完子树之后，把两次访问时间都记录下来，可知子树的节点的时间必然在根节点的两次时间之间，若$j$是$i$的子树中的一个节点，则必有$dfsNum[i][0]&lt;dfsNum[j][0]&lt;dfsNum[j][1]&lt;dfsNum[i][1]$<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> dfsNum[MAXN][<span class="number">2</span>]; <span class="comment">// dfsNum[MAXN][0]记录开始遍历前的时间，dfsNum[MAXN][1]记录遍历结束的时间</span></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; sons[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> deep;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> node)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  dfsNum[node][<span class="number">0</span>] = ++deep;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; sons[node].<span class="built_in">size</span>(); i++)</span><br><span class="line">  &#123;</span><br><span class="line">    dfs(sons[node][i]);</span><br><span class="line">  &#125;</span><br><span class="line">  dfsNum[node][<span class="number">1</span>] = ++deep;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://http//www.laughingtree.cn/2019/11/09/%E6%A6%82%E7%8E%87DP%E5%92%8C%E9%AB%98%E6%96%AF%E6%B6%88%E5%85%83/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="LiyunZhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LaughingTree">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/09/%E6%A6%82%E7%8E%87DP%E5%92%8C%E9%AB%98%E6%96%AF%E6%B6%88%E5%85%83/" class="post-title-link" itemprop="url">概率DP和高斯消元</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-11-09 00:43:07" itemprop="dateCreated datePublished" datetime="2019-11-09T00:43:07+08:00">2019-11-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-07 19:48:35" itemprop="dateModified" datetime="2020-08-07T19:48:35+08:00">2020-08-07</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95/" itemprop="url" rel="index">
                    <span itemprop="name">算法</span>
                  </a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/" itemprop="url" rel="index">
                    <span itemprop="name">动态规划</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>常见的问题就是一个点到终点的步数的期望，通常定义状态dp[i][j]表示的是从(i, j)这个点到终点的步数期望，然后有两种情况：</p>
<h1 id="满足无后效性"><a href="#满足无后效性" class="headerlink" title="满足无后效性"></a>满足无后效性</h1><p>就是每个dp值在被用之前就已经确定，就可以直接用递推，利用终点的dp值为0，反推回去，要的结果就是起点的dp值<br>例如<a href="http://acm.hdu.edu.cn/showproblem.php?pid=3853" target="_blank" rel="noopener">HDOJ-3853</a><br>由于只有右或下或原地三种情况，所以dp[i][j]只与dp[i + 1][j]和dp[i][j + 1]有关，满足无后效性。dp[i][j]就是dp[i + 1][j]和dp[i][j + 1]再走一步得到的，所以有<code>dp[i + 1][j] * p[i][j].down + dp[i][j + 1] * p[i][j].right + 2</code>。但是还没完，由于有回到原地的可能，所以以上都是在不回到原地的条件下的，所以这是一个条件概率问题，还要除以不回到原地的概率<code>1 - p[i][j].self</code><br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e3</span> + <span class="number">50</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> ans[MAXN][MAXN];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">p</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">double</span> self, right, down;</span><br><span class="line">&#125; possi[MAXN][MAXN];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> r, c;</span><br><span class="line">    <span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;r, &amp;c))</span><br><span class="line">    &#123;</span><br><span class="line">        rep(i, <span class="number">0</span>, r)</span><br><span class="line">        &#123;</span><br><span class="line">            rep(j, <span class="number">0</span>, c)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">scanf</span>(<span class="string">"%lf%lf%lf"</span>, &amp;possi[i][j].self, &amp;possi[i][j].right, &amp;possi[i][j].down);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        clr(ans, <span class="number">0</span>);</span><br><span class="line">        ans[r - <span class="number">1</span>][c - <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = r - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = c - <span class="number">1</span>; j &gt;= <span class="number">0</span>; j--)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(i == r - <span class="number">1</span> &amp;&amp; j == c - <span class="number">1</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(possi[i][j].self == <span class="number">1</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                ans[i][j] = (ans[i + <span class="number">1</span>][j] * possi[i][j].down + ans[i][j + <span class="number">1</span>] * possi[i][j].right + <span class="number">2</span>) / (<span class="number">1.0</span> - possi[i][j].self);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%.3lf\n"</span>, ans[<span class="number">0</span>][<span class="number">0</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="不满足无后效性"><a href="#不满足无后效性" class="headerlink" title="不满足无后效性"></a>不满足无后效性</h1><p>就是各个概率/期望之间形成一个循环，无法通过递归来求解。这时就要把每一个dp[i][j]都设置为一个未知数，对每一个dp[i][j]我们都可以得到一个线性方程，联立所有的线性方程，就可以得到一个n^2^元1次线性方程组，利用高斯消元法解线性方程组就可以得到答案<br>以下n为行数，m为列数，nun为总未知数的数量<br><strong>构造方程组</strong><br>构造方程组之前要先设元，我们设dp数组是从dp[0][0]开始的，就从上到下，从左到右，从x~0~开始设，所以dp[i][j]就被设为<code>i * m + j</code>。我们在下面的方程中移动各个元素的位置，使相同的未知数对齐，在系数矩阵中把他们的系数储存在不同行的同一列，系数矩阵的不同行储存的是不同方程的各个未知数的系数。还有一个常数数组b储存的是所有方程右边的常数<br><img src="/img/概率DP和高斯消元01.jpg" alt="20190518090332900.jpeg"><br><strong>高斯消元</strong><br>高斯消元就是要把系数矩阵化为一个上三角矩阵。高斯消元的过程中每一大步消一个元，总共要消num次元。每一大步的高斯消元又分为三小步：<br><code>稳定化</code>：这一步较为简单，要消第i个元的时候为了防止0系数被做为基础等一系列稳定性考虑，我们把所有i到num个方程中第i号元素系数最大的那个方程放到最上面，变成第i个方程。这里由于0到i - 1号方程已经消元完成，在后续消元时不需要考虑。<br><code>消元</code>：这一步中既要消a也要消b，要分为两次消。由于0到i - 1号已经消元完成，易知i到nun号所有方程的0到i - 1号元素的系数都是0，就没有必要对他们消元，也不能对他们消元。消元的目的是消除第i号元素，所以对于第j号方程的第k个元素的系数矩阵就是<code>a[j][k] -= a[k][j] / a[i][i] * a[i][k]</code>；对于第j号方程的常数矩阵<code>b[j] -= a[j][k] / a[i][i] * b[i]</code><br><code>回代</code>：消元结束后最后一个方程一定是已经解完了的，即只有一个未知数，我们就从最后一个方程往回代，消掉在它上面所有方程中对应的未知数，之后倒数第二个方程也只剩一个未知数，一直循环直到最后。有一个优化就是我们其实不需要修改系数矩阵的数值，和消元类似，我们每次只消一个元，所以就可以确定乘的倍数，而特殊的一点是每次操作都只会影响到我们要消的那个元素，所以每一步消元都不会影响到下一步消元的倍数，而可以预见的，在每一步都走完之后，系数矩阵变为一个对角阵，所以可以不修改系数矩阵。<br>注：系数矩阵和常数矩阵我们一般定义为double，为了防止误差，我们设定偏差值EPS = 1e-8</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">gauss</span><span class="params">(<span class="keyword">int</span> num)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; num; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">//稳定化</span></span><br><span class="line">		<span class="keyword">int</span> r = i;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; num; j++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(<span class="built_in">abs</span>(a[j][i]) &gt; <span class="built_in">abs</span>(a[r][i]))</span><br><span class="line">			&#123;</span><br><span class="line">				r = j;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">abs</span>(a[r][i]) &lt; EPS) <span class="comment">// 绝对值最大的a[r][i]都为0，不用再执行消元了</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(r != i) <span class="comment">// 交换行</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j = i; j &lt; num; j++)</span><br><span class="line">			&#123;</span><br><span class="line">				swap(a[i][j], a[r][j]);</span><br><span class="line">			&#125;</span><br><span class="line">			swap(b[i], b[r]);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//消元</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; num; j++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">double</span> mul = a[j][i] / a[i][i];</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> k = i; k &lt; num; k++)</span><br><span class="line">			&#123;</span><br><span class="line">				a[j][k] -= mul * a[i][k];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; num; j++)</span><br><span class="line">		&#123;</span><br><span class="line">			b[j] -= a[j][i] / a[i][i] * b[i];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//回代</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = num - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">abs</span>(a[i][i]) &lt; EPS)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; i; j++)</span><br><span class="line">		&#123;</span><br><span class="line">			b[j] -= a[j][i] / a[i][i] * b[i];</span><br><span class="line">		&#125;</span><br><span class="line">		b[i] /= a[i][i]; <span class="comment">// 化为单位矩阵</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如：<a href="http://acm.hdu.edu.cn/showproblem.php?pid=2262" target="_blank" rel="noopener">HDOJ 2262</a></p>
<h1 id="特殊"><a href="#特殊" class="headerlink" title="特殊"></a>特殊</h1><p>还有一些比较特殊的，他们一开始看起来不满足无后效性，但是通过不断地迭代变成满足无后效性<br>如：<a href="http://acm.hdu.edu.cn/showproblem.php?pid=4089" target="_blank" rel="noopener">HDOJ 4088</a><br>我们定义dp[i][j]表示队伍还剩下i个人，排在第j个时发生事件的概率。<br>1) 当<code>j == 1</code>时，<code>dp[i][j] = p1 * dp[i][j] + p2 * dp[i][i] + p4</code>三项分别表示激活失败留队、失去连接出队、服务器瘫痪<br>2) 当<code>2 ≤ j ≤ k</code>时，<code>dp[i][j] = p1 * dp[i][j] + p2 * dp[i][j - 1] + p3 * dp[i - 1][j - 1] + p4</code>，分别表示第一个人激活失败留队(什么都不变)、失去连接出队(队伍人数不变，但排位前进一名)、激活成功(队伍少一人，排位前进一位)、服务器瘫痪<br>3) 当<code>j &gt; k</code>时，<code>dp[i][j] = p1 * dp[i][j] + p2 * dp[i][j - 1] + p3 * dp[i - 1][j - 1]</code></p>
<p>在计算dp[i][j]时，dp[i - 1][j - 1]都已知了，可以作为常数处理，为了简便，我们记常数为c[j]<br>令p21 = p2 / (1 - p1)<br>p31 = p3 / (1 - p1)<br>p41 = p4 / (1 - p1)<br>则原式可以化简为<br>1) 当<code>j == 1</code>时，<code>dp[i][1] = p21 * dp[i][i] + c[1]</code>········································①<br>2) 当<code>2 ≤ j ≤ k</code>时，<code>dp[i][j] = p21 * dp[i][j - 1] + c[j]</code>·······························②<br>3) 当<code>j &gt; k</code>时，<code>dp[i][j] = p21 * dp[i][j - 1] + c[j]</code>····································③</p>
<p>②和③可以合并为：当<code>j &gt; 1</code>时，<code>dp[i][j] = p21 * dp[i][j - 1] + c[j]</code>···········④<br>看起来好像dp[i][i]会影响到dp[i][j]，形成一个循环，不满足无后效性，但是我们不断用④代入①，最终会得到式子如下：<br><img src="/img/概率DP和高斯消元02.jpg" alt="20190518222358442.jpeg"><br>然后就可以每次先算出$dp[i][1]$再递推</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">2e3</span> + <span class="number">50</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> EPS = <span class="number">1e-8</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> dp[MAXN][MAXN], c[MAXN], p[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, m, k;</span><br><span class="line">    <span class="keyword">double</span> p1, p2, p3, p4;</span><br><span class="line">    <span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">"%d%d%d%lf%lf%lf%lf"</span>, &amp;n, &amp;m, &amp;k, &amp;p1, &amp;p2, &amp;p3, &amp;p4))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">abs</span>(p4) &lt; EPS)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"0.00000\n"</span>);</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        p2 /= <span class="number">1</span> - p1;</span><br><span class="line">        p3 /= <span class="number">1</span> - p1;</span><br><span class="line">        p4 /= <span class="number">1</span> - p1;</span><br><span class="line">        p[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        rep(i, <span class="number">1</span>, n + <span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            p[i] = p[i - <span class="number">1</span>] * p2;</span><br><span class="line">        &#125;</span><br><span class="line">        dp[<span class="number">1</span>][<span class="number">1</span>] = p4 / (<span class="number">1</span> - p2);</span><br><span class="line">        rep(i, <span class="number">2</span>, n + <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            c[<span class="number">1</span>] = p4;</span><br><span class="line">            rep(j, <span class="number">1</span>, i + <span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(j &lt;= k)</span><br><span class="line">                &#123;</span><br><span class="line">                    c[j] = p3 * dp[i - <span class="number">1</span>][j - <span class="number">1</span>] + p4;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    c[j] = p3 * dp[i - <span class="number">1</span>][j - <span class="number">1</span>];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">double</span> sum = c[<span class="number">1</span>];</span><br><span class="line">            rep(j, <span class="number">2</span>, i + <span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                sum += c[j] * p[i + <span class="number">1</span> - j];</span><br><span class="line">            &#125;</span><br><span class="line">            dp[i][<span class="number">1</span>] = sum / (<span class="number">1</span> - p[i]);</span><br><span class="line">            rep(j, <span class="number">2</span>, i + <span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                dp[i][j] = dp[i][j - <span class="number">1</span>] * p2 + c[j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%.5lf\n"</span>, dp[n][m]);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://http//www.laughingtree.cn/2019/11/09/%E6%9C%80%E5%B0%8F%E8%B7%AF%E5%BE%84%E8%A6%86%E7%9B%96/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="LiyunZhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LaughingTree">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/09/%E6%9C%80%E5%B0%8F%E8%B7%AF%E5%BE%84%E8%A6%86%E7%9B%96/" class="post-title-link" itemprop="url">最小路径覆盖</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-11-09 00:42:21" itemprop="dateCreated datePublished" datetime="2019-11-09T00:42:21+08:00">2019-11-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-07 22:30:50" itemprop="dateModified" datetime="2020-08-07T22:30:50+08:00">2020-08-07</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95/" itemprop="url" rel="index">
                    <span itemprop="name">算法</span>
                  </a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95/%E5%9B%BE%E8%AE%BA/" itemprop="url" rel="index">
                    <span itemprop="name">图论</span>
                  </a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95/%E5%9B%BE%E8%AE%BA/%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84/" itemprop="url" rel="index">
                    <span itemprop="name">最短路径</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="半径为k的树上覆盖"><a href="#半径为k的树上覆盖" class="headerlink" title="半径为k的树上覆盖"></a>半径为k的树上覆盖</h1><p>在一棵树上，每条边的权值都为1，覆盖半径为k<br>用贪心，从最深的节点开始，如果没有被覆盖就把它的第k代祖先覆盖，并更新。<br>一个结构体存储两个值：编号和深度，利用深度排序之后再按编号顺序贪心；<br>dist数组：存储每个结点最近的覆盖点的距离<br>father数组：存储每个结点的父节点</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> k, <span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    sort(arr + <span class="number">1</span>, arr + <span class="number">1</span> + n, cmp);</span><br><span class="line">    clr(dist, MINF);</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    repLE(i, <span class="number">1</span>, n)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> sel = arr[i].id;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//更新当前贪心节点的最近覆盖距离</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = father[sel], cnt = <span class="number">1</span>; cnt &lt;= k &amp;&amp; j != <span class="number">0</span>; j = father[j], cnt++)</span><br><span class="line">        &#123;</span><br><span class="line">        	<span class="comment">// 距离为上i代祖先的最近覆盖距离，再加上从该祖先到该点的距离</span></span><br><span class="line">            dist[sel] = min(dist[sel], dist[j] + cnt);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 如果最近的覆盖距离大于k，说明没有被覆盖</span></span><br><span class="line">        <span class="keyword">if</span> (dist[sel] &gt; k)</span><br><span class="line">        &#123;</span><br><span class="line">            ans++; <span class="comment">// 增加一个覆盖点</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = sel, cnt = k; cnt &gt;= -k &amp;&amp; j != <span class="number">0</span>; j = father[j], cnt--)</span><br><span class="line">            &#123;</span><br><span class="line">                dist[j] = min(dist[j], <span class="built_in">abs</span>(cnt));</span><br><span class="line">                <span class="comment">// 更新当前贪心点上k代祖先的下k代和上k代之内的所有直系覆盖范围</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在更新距离的时候，更新的是直系的距离，实际上k代祖先的后代可以不更新，因为后代只有：1、已经访问过的不会再访问；2、稍后访问，访问时会自动更新(旁系后代的更新方式)<br>例题：<br><a href="https://www.luogu.org/problemnew/show/P3942" target="_blank" rel="noopener">洛谷 P3942</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://http//www.laughingtree.cn/2019/11/09/%E6%AC%A1%E7%9F%AD%E8%B7%AF%E3%80%81k%E7%9F%AD%E8%B7%AF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="LiyunZhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LaughingTree">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/09/%E6%AC%A1%E7%9F%AD%E8%B7%AF%E3%80%81k%E7%9F%AD%E8%B7%AF/" class="post-title-link" itemprop="url">次短路、k短路</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-11-09 00:41:12" itemprop="dateCreated datePublished" datetime="2019-11-09T00:41:12+08:00">2019-11-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-07 17:43:01" itemprop="dateModified" datetime="2020-08-07T17:43:01+08:00">2020-08-07</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95/" itemprop="url" rel="index">
                    <span itemprop="name">算法</span>
                  </a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95/%E5%9B%BE%E8%AE%BA/" itemprop="url" rel="index">
                    <span itemprop="name">图论</span>
                  </a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95/%E5%9B%BE%E8%AE%BA/%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84/" itemprop="url" rel="index">
                    <span itemprop="name">最短路径</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="次短路-纯dij"><a href="#次短路-纯dij" class="headerlink" title="次短路(纯dij)"></a>次短路(纯dij)</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">qnode</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> v, c;</span><br><span class="line">    </span><br><span class="line">    qnode(<span class="keyword">void</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        v = c = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    qnode (<span class="keyword">int</span> val, <span class="keyword">int</span> cost)</span><br><span class="line">    &#123;</span><br><span class="line">        v = val;</span><br><span class="line">        c = cost;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> qnode &amp; r) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> c &gt; r.c;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; ;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> v, cost;</span><br><span class="line">    </span><br><span class="line">    edge (<span class="keyword">void</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        v = cost = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    edge (<span class="keyword">int</span> val, <span class="keyword">int</span> c)</span><br><span class="line">    &#123;</span><br><span class="line">        v = val;</span><br><span class="line">        cost = c;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; ;</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span>&lt;edge&gt; e[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> dist[MAXN][<span class="number">5</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dij</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> start)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    clr(dist, INF);</span><br><span class="line">    priority_queue&lt;qnode&gt; que;</span><br><span class="line">    <span class="keyword">while</span> (!que.empty())</span><br><span class="line">    &#123;</span><br><span class="line">        que.pop();</span><br><span class="line">    &#125;</span><br><span class="line">    dist[start][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    que.push(qnode(start, <span class="number">0</span>));</span><br><span class="line">    qnode tmp;</span><br><span class="line">    <span class="keyword">while</span> (!que.empty())</span><br><span class="line">    &#123;</span><br><span class="line">        tmp = que.top();</span><br><span class="line">        que.pop();</span><br><span class="line">        <span class="keyword">int</span> u = tmp.v;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; e[u].size(); i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> v = e[u][i].v;</span><br><span class="line">            <span class="keyword">int</span> cost = e[u][i].cost + tmp.c;</span><br><span class="line">            <span class="keyword">if</span> (dist[v][<span class="number">0</span>] &gt; cost)</span><br><span class="line">            &#123;</span><br><span class="line">                swap(dist[v][<span class="number">0</span>], cost);</span><br><span class="line">                que.push(qnode(v, dist[v][<span class="number">0</span>]));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (dist[v][<span class="number">0</span>] &lt; cost &amp;&amp; cost &lt; dist[v][<span class="number">1</span>])</span><br><span class="line">            &#123;</span><br><span class="line">                dist[v][<span class="number">1</span>] = cost;</span><br><span class="line">                que.push(qnode(v, dist[v][<span class="number">1</span>]));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="k短路-dij-A"><a href="#k短路-dij-A" class="headerlink" title="k短路(dij + A*)"></a>k短路(dij + A*)</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> S,T,K;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> to,cost;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">vector</span>&lt;edge&gt;E[N],G[N];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> dis[N];</span><br><span class="line"><span class="keyword">bool</span> vis[N];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Anode</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> to,d,all;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> Anode &amp;_)<span class="keyword">const</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> all==_.all?d&gt;_.d:all&gt;_.all;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">priority_queue&lt;Anode&gt;Star;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Astar</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(dis[S]==<span class="number">0x3f3f3f3f</span>)<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">if</span>(S==T)K++;</span><br><span class="line">    <span class="keyword">int</span> cnt=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(!Star.empty())Star.pop();</span><br><span class="line"></span><br><span class="line">    Star.push((Anode)&#123;S,<span class="number">0</span>,dis[S]&#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(!Star.empty())&#123;</span><br><span class="line">        Anode now=Star.top();Star.pop();</span><br><span class="line">        <span class="keyword">int</span> x=now.to;</span><br><span class="line">        <span class="keyword">if</span>(x==T)&#123;</span><br><span class="line">            cnt++;</span><br><span class="line">            <span class="keyword">if</span>(cnt==K)<span class="keyword">return</span> now.d;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;(<span class="keyword">int</span>)E[x].size();i++)&#123;</span><br><span class="line">            <span class="keyword">int</span> y=E[x][i].to;</span><br><span class="line">            Star.push((Anode)&#123;y,now.d+E[x][i].cost,now.d+E[x][i].cost+dis[y]&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span><span class="number">-1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://http//www.laughingtree.cn/2019/11/09/%E5%8C%BA%E9%97%B4DP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="LiyunZhang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LaughingTree">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/09/%E5%8C%BA%E9%97%B4DP/" class="post-title-link" itemprop="url">区间DP</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-11-09 00:39:46" itemprop="dateCreated datePublished" datetime="2019-11-09T00:39:46+08:00">2019-11-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-07 17:41:09" itemprop="dateModified" datetime="2020-08-07T17:41:09+08:00">2020-08-07</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95/" itemprop="url" rel="index">
                    <span itemprop="name">算法</span>
                  </a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/" itemprop="url" rel="index">
                    <span itemprop="name">动态规划</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>区间DP的作用就是解决区间内的最优值。通常是化为几个小区间的和。<br><strong>处理方式</strong>：区间[i, j]内的最优值<code>dp[i][j] = max/min(dp[i][k] + dp[k][j] + sth, dp[i][j])</code>枚举所有的区间划分方式k，求得最优值。<br><strong>但是枚举的顺序应该是怎样的呢？</strong><br>首先容易想到的就是枚举区间的两个端点，i、j再枚举其中的k，但是这样不可取，每次枚举的时候已经枚举的都是区间开始端点小于i的区间，显然区间[k, j]还没有枚举过。我们可以发现求区间[i, j]时要用到的两个子区间的长度都是小于待求区间的，所以我们可以想到按区间长度枚举。下面上板子</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> dp[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	这里是合并两个区间的处理</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">intervalDP</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> len = <span class="number">1</span>; len &lt; n; len++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, j = i + len; j &lt; n &amp;&amp; i &lt; n; i++, j = i + len)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> k = i; k &lt; j; k++)</span><br><span class="line">			&#123;</span><br><span class="line">				dp[i][j] = max(dp[i][j], dp[i][k] + dp[k + <span class="number">1</span>][j] + merge());</span><br><span class="line">			]</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><p><a href="https://vjudge.net/problem/POJ-3186" target="_blank" rel="noopener">POJ 3186</a><br>定义状态区间[i, j]表示在只有[i, j]时能够取到的最大值，此时要么取头要么取尾，所以取完要么剩下[i + 1, j]，要么剩下[i, j - 1]。原本有n个，还剩j - i + 1个，则当前是取<code>第n - (j - i + 1) + 1 = n - j + i个</code>。所以如果取头，获得的价值就是<code>val[i] * (n - j + i)</code>，如果取尾，就是<code>val[j] * (n - j + i)</code>。所以得到状态转移方程<br><code>dp[i][j] = max(dp[i + 1][j] + val[i] * (n - j + i), dp[i][j - 1] * val[j] * (n - j + i))</code><br>求解顺序：首先对于所有的dp[i][i]，显然只有i元素时能取到的最大值就是val[i]。之后注意到我们需要用的的有下一行和左一个，所以我们的更新顺序因该是从下往上，从左往右更新<br>最后的答案就是dp[1][n] (假设下标是从1开始)</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(ele, init, lim) for(int ele = init; ele &lt; lim; ele++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> clr(arr, init) memset(arr, init, sizeof(arr))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">2010</span>;</span><br><span class="line"><span class="keyword">int</span> dp[MAXN][MAXN];</span><br><span class="line"><span class="keyword">int</span> val[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">memset</span> (dp, <span class="number">0</span>, <span class="keyword">sizeof</span>(dp));</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;val[i]);</span><br><span class="line">            dp[i][i] = val[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &lt;= n; ++j)</span><br><span class="line">            &#123;</span><br><span class="line">                dp[i][j] = <span class="built_in">max</span>(dp[i + <span class="number">1</span>][j] + val[i] * (n - (j - i + <span class="number">1</span>) + <span class="number">1</span>), dp[i][j - <span class="number">1</span>] + val[j] *(n - (j - i + <span class="number">1</span>) + <span class="number">1</span>) );</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, dp[<span class="number">1</span>][n]);</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>模版题：<a href="https://www.luogu.org/problemnew/show/P1880" target="_blank" rel="noopener">洛谷 P1880</a></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">205</span>;</span><br><span class="line"><span class="keyword">int</span> num[MAXN], sum[MAXN];</span><br><span class="line"><span class="keyword">int</span> dp1[MAXN][MAXN], dp2[MAXN][MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    scInt(n);</span><br><span class="line">    repLE(i, <span class="number">1</span>, n)</span><br><span class="line">    &#123;</span><br><span class="line">        scInt(num[i]);</span><br><span class="line">        num[n + i] = num[i];</span><br><span class="line">        sum[i] = sum[i - <span class="number">1</span>] + num[i];</span><br><span class="line">    &#125;</span><br><span class="line">    repLE(i, n + <span class="number">1</span>, n * <span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        sum[i] = sum[i - <span class="number">1</span>] + num[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> p=<span class="number">1</span>;p&lt;n;p++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>,j=i+p;(j&lt;n+n) &amp;&amp; (i&lt;n+n);i++,j=i+p)</span><br><span class="line">        &#123;</span><br><span class="line">            dp2[i][j] = INF;</span><br><span class="line">            repLess(k, i, j)</span><br><span class="line">            &#123;</span><br><span class="line">                dp1[i][j] = max(dp1[i][j], dp1[i][k] + dp1[k + <span class="number">1</span>][j] + sum[j] - sum[i - <span class="number">1</span>]);</span><br><span class="line">                dp2[i][j] = min(dp2[i][j], dp2[i][k] + dp2[k + <span class="number">1</span>][j] + sum[j] - sum[i - <span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> maxAns = <span class="number">0</span>, minAns = INF;</span><br><span class="line">    repLE(i, <span class="number">1</span>, n)</span><br><span class="line">    &#123;</span><br><span class="line">        maxAns = max(maxAns, dp1[i][i + n - <span class="number">1</span>]);</span><br><span class="line">        minAns = min(minAns, dp2[i][i + n - <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n%d\n"</span>, minAns, maxAns);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

  </div>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/13/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/">13</a><span class="page-number current">14</span><a class="page-number" href="/page/15/">15</a><span class="space">&hellip;</span><a class="page-number" href="/page/20/">20</a><a class="extend next" rel="next" href="/page/15/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="LiyunZhang"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">LiyunZhang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">197</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">31</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">26</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Liyun Zhang</span>
</div>
<div class="BbeiAn-info">
       浙ICP备 -
    <a target="_blank" href="http://www.miitbeian.gov.cn/" style="color:#ffffff"  rel="nofollow">19047088号-1</a> <!--a标签中增加nofollow属性，避免爬虫出站。-->|
    <a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=33011802001835" style="color:#ffffff;text-decoration:none;padding-left:30px;background:url(https://s1.ax1x.com/2018/09/29/ilmwIH.png) no-repeat left center" rel="nofollow">浙公网安备 33011802001835号</a>      <!--这里将图标作为了背景，以使得能和后面的文字在同一行-->

</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  
      
<script type="text/x-mathjax-config">

  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$', '$'], ['\\(', '\\)'] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      equationNumbers: {
        autoNumber: 'AMS'
      }
    }
  });

  MathJax.Hub.Register.StartupHook('TeX Jax Ready', function() {
    MathJax.InputJax.TeX.prefilterHooks.Add(function(data) {
      if (data.display) {
        var next = data.script.nextSibling;
        while (next && next.nodeName.toLowerCase() === '#text') {
          next = next.nextSibling;
        }
        if (next && next.nodeName.toLowerCase() === 'br') {
          next.parentNode.removeChild(next);
        }
      }
    });
  });

  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for (i = 0; i < all.length; i += 1) {
      element = document.getElementById(all[i].inputID + '-Frame').parentNode;
      if (element.nodeName.toLowerCase() == 'li') {
        element = element.parentNode;
      }
      element.classList.add('has-jax');
    }
  });
</script>
<script>
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML', () => {
    MathJax.Hub.Typeset();
  }, window.MathJax);
</script>

    

  

</body>
</html>
